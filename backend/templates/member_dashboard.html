<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Member Dashboard</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet"/>
    <style>
        * { margin:0; padding:0; box-sizing:border-box; }
        body { font-family:'Poppins',sans-serif; background:#f0f2f5; }
        header { background:linear-gradient(135deg,#0f52ba 0%,#9b59b6 100%); color:white; padding:1rem; }
        header h1 { font-size:1.5rem; }
        .navbar { display:flex; justify-content:space-between; align-items:center; max-width:1200px; margin:0 auto; padding:0 2rem; }
        .nav-links { display:flex; gap:2rem; align-items:center; }
        .nav-links a { color:white; text-decoration:none; font-weight:600; }
        .nav-links a:hover { opacity:0.8; }
        .logout-btn { background:#ef4444; color:white; border:none; padding:0.8rem 1.5rem; border-radius:0.5rem; cursor:pointer; font-weight:600; }
        .logout-btn:hover { background:#dc2626; }
        .container { max-width:1200px; margin:2rem auto; padding:0 1rem; }
        h2 { color:#0f52ba; margin:2rem 0 1rem; font-size:1.3rem; }
        .cards-grid { display:grid; grid-template-columns:repeat(auto-fit,minmax(200px,1fr)); gap:1rem; margin:1rem 0; }
        .card { background:white; padding:1.5rem; border-radius:0.8rem; box-shadow:0 4px 12px rgba(0,0,0,0.1); text-align:center; cursor:pointer; transition:all 0.3s; }
        .card:hover { transform:translateY(-5px); box-shadow:0 8px 20px rgba(0,0,0,0.15); }
        .card i { font-size:2.5rem; color:#0f52ba; margin-bottom:0.5rem; }
        .card h3 { color:#333; margin-bottom:0.5rem; }
        .card p { color:#666; font-size:0.9rem; }
        .card a { color:#0f52ba; text-decoration:none; font-weight:600; margin-top:1rem; display:block; }
        table { width:100%; background:white; border-collapse:collapse; border-radius:0.8rem; overflow:hidden; box-shadow:0 4px 12px rgba(0,0,0,0.1); margin:1rem 0; }
        thead { background:#0f52ba; color:white; }
        th, td { padding:1rem; text-align:left; border-bottom:1px solid #eee; }
        th { font-weight:600; }
        tr:hover { background:#f9f9f9; }
        .empty { text-align:center; color:#666; padding:2rem; }
    </style>
</head>
<body>
<header>
    <div class="navbar">
        <h1><i class="fas fa-university"></i> Member Dashboard</h1>
        <div style="display:flex; gap:1rem;">
            <a href="/" style="color:white; text-decoration:none;">Home</a>
            <form action="/logout" method="get" style="margin:0;">
                <button type="submit" class="logout-btn">Log Out</button>
            </form>
        </div>
    </div>
</header>

<div class="container">
    <h2>Welcome, {{ member.name }}!</h2>
    <p style="color:#666; margin-bottom:2rem;">Account No: <strong>{{ member.account_no }}</strong></p>
    
    <h2>Quick Actions</h2>
    <div class="cards-grid">
        <div class="card">
            <i class="fas fa-file-invoice-dollar"></i>
            <h3>Apply for Loan</h3>
            <p>Get quick loans with easy EMIs</p>
            <a href="/loan-application">Apply Now</a>
        </div>
        <div class="card">
            <i class="fas fa-piggy-bank"></i>
            <h3>Fixed Deposit</h3>
            <p>Earn guaranteed returns</p>
            <a href="/fd-application">Invest Now</a>
        </div>
        <div class="card">
            <i class="fas fa-handshake"></i>
            <h3>Buy Shares</h3>
            <p>Invest in society shares</p>
            <a href="/share-investment">Invest Now</a>
        </div>
        <div class="card">
            <i class="fas fa-money-check-alt"></i>
            <h3>Loan Repayment</h3>
            <p>Pay loans and pre-closure</p>
            <a href="/loan-repayment">Pay Now</a>
        </div>
    </div>

    <h2>Your Loans</h2>
    {% if loans %}
    <table>
        <thead>
            <tr><th>Loan ID</th><th>Amount (₹)</th><th>Interest Rate</th><th>Tenure (months)</th><th>Status</th></tr>
        </thead>
        <tbody>
            {% for loan in loans %}
            <tr>
                <td>#{{ loan.id }}</td>
                <td>₹{{ "{:.2f}".format(loan.amount) }}</td>
                <td>{{ loan.interest_rate }}%</td>
                <td>{{ loan.tenure_months }}</td>
                <td><span style="background:#{{ 'c3e6cb' if loan.status == 'Approved' else 'ffeaa7' if loan.status == 'Pending' else 'f8d7da' }}; padding:0.3rem 0.8rem; border-radius:0.3rem;">{{ loan.status }}</span></td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
    {% else %}
    <div class="empty">No loans yet. <a href="/loan-application" style="color:#0f52ba; text-decoration:underline;">Apply for a loan</a></div>
    {% endif %}

    <h2>Your Fixed Deposits</h2>
    {% if deposits %}
    <table>
        <thead>
            <tr><th>FD ID</th><th>Amount (₹)</th><th>Type</th><th>Maturity Date</th><th>Status</th></tr>
        </thead>
        <tbody>
            {% for deposit in deposits %}
            <tr>
                <td>#{{ deposit.id }}</td>
                <td>₹{{ "{:.2f}".format(deposit.amount) }}</td>
                <td>{{ deposit.type }}</td>
                <td>{{ deposit.maturity_date }}</td>
                <td><span style="background:#{{ 'c3e6cb' if deposit.status == 'Active' else 'ffeaa7' if deposit.status == 'Pending' else 'f8d7da' }}; padding:0.3rem 0.8rem; border-radius:0.3rem;">{{ deposit.status }}</span></td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
    {% else %}
    <div class="empty">No FDs yet. <a href="/fd-application" style="color:#0f52ba; text-decoration:underline;">Open a Fixed Deposit</a></div>
    {% endif %}

    <h2>Your Share Holdings</h2>
    {% if shares %}
    <table>
        <thead>
            <tr><th>Share ID</th><th>Quantity</th><th>Per Share (₹)</th><th>Total Amount (₹)</th><th>Status</th></tr>
        </thead>
        <tbody>
            {% for share in shares %}
            <tr>
                <td>#{{ share.id }}</td>
                <td>{{ share.quantity }}</td>
                <td>₹{{ "{:.2f}".format(share.amount_per_share) }}</td>
                <td>₹{{ "{:.2f}".format(share.total_amount) }}</td>
                <td><span style="background:#{{ 'c3e6cb' if share.status == 'Active' else 'ffeaa7' if share.status == 'Pending' else 'f8d7da' }}; padding:0.3rem 0.8rem; border-radius:0.3rem;">{{ share.status }}</span></td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
    {% else %}
    <div class="empty">No shares yet. <a href="/share-investment" style="color:#0f52ba; text-decoration:underline;">Invest in shares</a></div>
    {% endif %}

    <h2>Recent Transactions</h2>
    {% if transactions %}
    <table>
        <thead>
            <tr><th>Transaction ID</th><th>Type</th><th>Amount (₹)</th><th>Description</th><th>Date</th></tr>
        </thead>
        <tbody>
            {% for txn in transactions|slice(":10") %}
            <tr>
                <td>#{{ txn.id }}</td>
                <td>{{ txn.type }}</td>
                <td>₹{{ "{:.2f}".format(txn.amount) }}</td>
                <td>{{ txn.description or '-' }}</td>
                <td>{{ txn.created_at.strftime('%Y-%m-%d %H:%M') }}</td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
    {% else %}
    <div class="empty">No transactions yet.</div>
    {% endif %}
</div>
</body>
</html>
